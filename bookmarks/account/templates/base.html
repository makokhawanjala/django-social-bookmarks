{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{% block title %}Bookmarks{% endblock %}</title>

  <!-- Bootstrap 5 CDN -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{% static 'css/style.css' %}">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  
  <style>
    :root {
      --win11-bg: #f3f3f3;
      --win11-sidebar: #ffffff;
      --win11-content: #ffffff;
      --win11-border: #e5e5e5;
      --win11-text-primary: #323130;
      --win11-text-secondary: #605e5c;
      --win11-accent: #198754;
      --win11-hover: #f9f9f9;
    }

    body {
      background-color: var(--win11-bg);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      color: var(--win11-text-primary);
    }

    .settings-container {
      height: 100vh;
      overflow: hidden;
    }

    .settings-header {
      background: var(--win11-accent);
      color: white;
      padding: 12px 24px;
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .settings-header h1 {
      font-size: 28px;
      font-weight: 600;
      margin: 0;
      color: white;
    }

    .back-btn {
      background: none;
      border: none;
      padding: 8px;
      border-radius: 4px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
    }

    .back-btn:hover {
      background: rgba(255,255,255,0.1);
    }

    .auth-section {
      color: white;
      margin-left: auto;
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .auth-btn {
      background: none;
      border: 1px solid rgba(255,255,255,0.3);
      color: white;
      padding: 6px 16px;
      border-radius: 4px;
      text-decoration: none;
      font-size: 14px;
      transition: all 0.2s;
    }

    .auth-btn:hover {
      background: rgba(255,255,255,0.1);
      color: white;
      text-decoration: none;
    }

    .settings-body {
      display: flex;
      height: calc(100vh - 80px);
    }

    .settings-sidebar {
      width: 300px;
      background: var(--win11-sidebar);
      border-right: 1px solid var(--win11-border);
      overflow-y: auto;
      padding: 0;
    }

    .sidebar-item {
      display: flex;
      align-items: center;
      padding: 12px 24px;
      text-decoration: none;
      color: var(--win11-text-primary);
      border: none;
      background: none;
      width: 100%;
      text-align: left;
      gap: 16px;
      transition: background-color 0.2s;
    }

    .sidebar-item:hover {
      background: var(--win11-hover);
      color: var(--win11-text-primary);
    }

    .sidebar-item.active {
      background: var(--win11-hover);
      border-right: 3px solid var(--win11-accent);
    }

    .sidebar-icon {
      font-size: 16px;
      width: 16px;
      color: var(--win11-text-secondary);
    }

    .sidebar-text {
      font-size: 14px;
    }

    .settings-content {
      flex: 1;
      background: var(--win11-content);
      overflow-y: auto;
      padding: 32px;
    }

    .content-section {
      margin-bottom: 40px;
    }

    .section-title {
      font-size: 20px;
      font-weight: 600;
      margin-bottom: 16px;
      color: var(--win11-text-primary);
    }

    .device-card {
      background: var(--win11-content);
      border: 1px solid var(--win11-border);
      border-radius: 8px;
      padding: 20px;
      display: flex;
      align-items: center;
      gap: 16px;
      margin-bottom: 24px;
    }

    .device-icon {
      width: 48px;
      height: 48px;
      background: var(--win11-accent);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 20px;
    }

    .device-info h3 {
      font-size: 16px;
      font-weight: 600;
      margin: 0 0 4px 0;
      color: var(--win11-text-primary);
    }

    .device-info p {
      font-size: 14px;
      color: var(--win11-text-secondary);
      margin: 0 0 8px 0;
    }

    .device-link {
      color: var(--win11-accent);
      text-decoration: none;
      font-size: 14px;
    }

    .device-link:hover {
      text-decoration: underline;
      color: var(--win11-accent);
    }

    .status-indicators {
      display: flex;
      gap: 32px;
      margin-bottom: 24px;
    }

    .status-item {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .status-icon {
      width: 16px;
      height: 16px;
      color: var(--win11-accent);
    }

    .status-text {
      font-size: 14px;
      color: var(--win11-text-secondary);
    }

    .bookmarks-account-section {
      background: var(--win11-content);
      border: 1px solid var(--win11-border);
      border-radius: 8px;
      padding: 24px;
      text-align: center;
      margin-bottom: 32px;
    }

    .bm-logo {
      width: 24px;
      height: 24px;
      margin: 0 auto 16px;
    }

    .bm-title {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 8px;
      color: var(--win11-text-primary);
    }

    .bm-subtitle {
      font-size: 14px;
      color: var(--win11-text-secondary);
      margin-bottom: 16px;
    }

    .app-icons {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-bottom: 20px;
    }

    .app-icon {
      width: 32px;
      height: 32px;
      border-radius: 4px;
      background: var(--win11-accent);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 14px;
    }

    .sign-in-btn {
      background: var(--win11-accent);
      color: white;
      border: none;
      padding: 8px 20px;
      border-radius: 4px;
      font-size: 14px;
      cursor: pointer;
      text-decoration: none;
    }

    .sign-in-btn:hover {
      background: #146c43;
      color: white;
      text-decoration: none;
    }

    .personalization-section {
      margin-bottom: 32px;
    }

    .theme-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      margin-bottom: 24px;
    }

    .theme-option {
      aspect-ratio: 16/9;
      border: 2px solid var(--win11-border);
      border-radius: 8px;
      overflow: hidden;
      cursor: pointer;
      position: relative;
    }

    .theme-option.active {
      border-color: var(--win11-accent);
    }

    .theme-preview {
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #198754 0%, #20c997 100%);
      position: relative;
    }

    .theme-preview.light {
      background: linear-gradient(135deg, #f0f0f0 0%, #ffffff 100%);
    }

    .theme-preview.dark {
      background: linear-gradient(135deg, #1e1e1e 0%, #2d2d2d 100%);
    }

    .color-mode-section {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 0;
      border-bottom: 1px solid var(--win11-border);
    }

    .color-mode-label {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 14px;
      color: var(--win11-text-primary);
    }

    .dropdown-custom {
      border: 1px solid var(--win11-border);
      border-radius: 4px;
      padding: 6px 12px;
      background: white;
      font-size: 14px;
    }

    .recommended-settings {
      background: var(--win11-content);
      border: 1px solid var(--win11-border);
      border-radius: 8px;
      overflow: hidden;
    }

    .recommended-header {
      padding: 20px 24px 16px;
      border-bottom: 1px solid var(--win11-border);
    }

    .recommended-title {
      font-size: 16px;
      font-weight: 600;
      margin: 0 0 4px 0;
      color: var(--win11-text-primary);
    }

    .recommended-subtitle {
      font-size: 14px;
      color: var(--win11-text-secondary);
      margin: 0;
    }

    .setting-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 24px;
      border-bottom: 1px solid var(--win11-border);
      cursor: pointer;
      transition: background-color 0.2s;
    }

    .setting-item:last-child {
      border-bottom: none;
    }

    .setting-item:hover {
      background: var(--win11-hover);
    }

    .setting-info {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .setting-icon {
      font-size: 16px;
      color: var(--win11-text-secondary);
    }

    .setting-text {
      font-size: 14px;
      color: var(--win11-text-primary);
    }

    .setting-arrow {
      font-size: 12px;
      color: var(--win11-text-secondary);
    }

    /* Footer styles */
    .win11-footer {
      background: var(--win11-content);
      border-top: 1px solid var(--win11-border);
      padding: 16px 0;
      text-align: center;
      color: var(--win11-text-secondary);
      font-size: 14px;
    }

    /* Alert styles */
    .alert {
      border: 1px solid var(--win11-border);
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 16px;
    }

    .alert-success {
      background: #d1e7dd;
      border-color: #badbcc;
      color: #0f5132;
    }

    .alert-danger {
      background: #f8d7da;
      border-color: #f5c2c7;
      color: #842029;
    }

    .alert-warning {
      background: #fff3cd;
      border-color: #ffecb5;
      color: #664d03;
    }

    .alert-info {
      background: #d1ecf1;
      border-color: #b8daff;
      color: #055160;
    }
  </style>

  {% block extra_css %}{% endblock %}
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</head>

<body>
  <div class="settings-container">
    <!-- Header -->
    <div class="settings-header">
      <h1>Bookmarks</h1>
      
      <div class="auth-section">
        {% if request.user.is_authenticated %}
          <span>Hello, {{ request.user.first_name|default:request.user.username }}</span>
          <form action="{% url 'logout' %}" method="post" class="d-inline">
            {% csrf_token %}
            <button type="submit" class="auth-btn">Logout</button>
          </form>
        {% else %}
          <a href="{% url 'login' %}" class="auth-btn">Log in</a>
        {% endif %}
      </div>
    </div>

    <!-- Body -->
    <div class="settings-body">
      <!-- Sidebar Navigation -->
      <div class="settings-sidebar">
        {% if request.user.is_authenticated %}
        <a href="{% url 'dashboard' %}" class="sidebar-item {% if section == 'dashboard' %}active{% endif %}">
          <i class="bi bi-house sidebar-icon"></i>
          <span class="sidebar-text">My Dashboard</span>
        </a>
        <a href="{% url 'images:list' %}" class="sidebar-item {% if section == 'images' %}active{% endif %}">
          <i class="bi bi-collection sidebar-icon"></i>
          <span class="sidebar-text">Images</span>
        </a>
        <a href="{% url 'user_list' %}" class="sidebar-item {% if section == 'people' %}active{% endif %}">
          <i class="bi bi-people sidebar-icon"></i>
          <span class="sidebar-text">People</span>
        </a>
        <a href="{% url 'edit' %}" class="sidebar-item">
          <i class="bi bi-person-gear sidebar-icon"></i>
          <span class="sidebar-text">Edit Profile</span>
        </a>
        {% endif %}
      </div>

      <!-- Main Content Area -->
      <div class="settings-content">
        {% if messages %}
          {% for message in messages %}
            <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
              {{ message|safe }}
              <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
          {% endfor %}
        {% endif %}

        {% block content %}
        <!-- Default Home Content -->
        <div class="content-section">
          <!-- Device Information -->
          <div class="device-card">
            <div class="device-icon">
              <i class="bi bi-bookmark-star"></i>
            </div>
            <div class="device-info">
              <h3>{{ request.user.username|upper }}-BOOKMARKS</h3>
              <p>Bookmarks Platform</p>
              <a href="#" class="device-link">Manage Account</a>
            </div>
          </div>

          <!-- Status Indicators -->
          <div class="status-indicators">
            <div class="status-item">
              <i class="bi bi-wifi status-icon"></i>
              <div>
                <div class="status-text">Connection</div>
                <div class="status-text" style="font-weight: 600;">Online</div>
              </div>
            </div>
            <div class="status-item">
              <i class="bi bi-clock-history status-icon"></i>
              <div>
                <div class="status-text">Last Activity</div>
                <div class="status-text" style="font-weight: 600;">Just now</div>
              </div>
            </div>
          </div>

          <!-- Account Section for non-authenticated users -->
          {% if not request.user.is_authenticated %}
          <div class="bookmarks-account-section">
            <div class="bm-logo">
              <i class="bi bi-bookmark-star" style="font-size: 24px; color: var(--win11-accent);"></i>
            </div>
            <div class="bm-title">Access your Bookmarks account</div>
            <div class="bm-subtitle">Sign in to manage your bookmarks, images, and connect with people.</div>
            <div class="app-icons">
              <div class="app-icon"><i class="bi bi-bookmark"></i></div>
              <div class="app-icon"><i class="bi bi-image"></i></div>
              <div class="app-icon"><i class="bi bi-people"></i></div>
              <div class="app-icon"><i class="bi bi-heart"></i></div>
              <div class="app-icon"><i class="bi bi-star"></i></div>
            </div>
            <a href="{% url 'login' %}" class="sign-in-btn">Sign in</a>
          </div>
          {% endif %}

          <!-- Personalization Section -->
          <div class="personalization-section">
            <h2 class="section-title">Personalize your experience</h2>
            <div class="theme-grid">
              <div class="theme-option active">
                <div class="theme-preview light"></div>
              </div>
              <div class="theme-option">
                <div class="theme-preview dark"></div>
              </div>
              <div class="theme-option">
                <div class="theme-preview"></div>
              </div>
              <div class="theme-option">
                <div class="theme-preview" style="background: linear-gradient(135deg, #8B5CF6 0%, #A855F7 100%);"></div>
              </div>
              <div class="theme-option">
                <div class="theme-preview" style="background: linear-gradient(135deg, #EF4444 0%, #F97316 100%);"></div>
              </div>
              <div class="theme-option">
                <div class="theme-preview" style="background: linear-gradient(135deg, #10B981 0%, #059669 100%);"></div>
              </div>
            </div>

            <div class="color-mode-section">
              <div class="color-mode-label">
                <i class="bi bi-circle-half"></i>
                <span>Color mode</span>
              </div>
              <select class="dropdown-custom">
                <option>Light</option>
                <option>Dark</option>
                <option>Auto</option>
              </select>
            </div>

            <div style="padding: 16px 0;">
              <a href="#" class="device-link">Browse more themes and customizations</a>
            </div>
          </div>

          <!-- Quick Access Settings -->
          <div class="recommended-settings">
            <div class="recommended-header">
              <h3 class="recommended-title">Quick Access</h3>
              <p class="recommended-subtitle">Frequently used features</p>
            </div>
            {% if request.user.is_authenticated %}
            <a href="{% url 'dashboard' %}" class="setting-item" style="text-decoration: none; color: inherit;">
              <div class="setting-info">
                <i class="bi bi-house setting-icon"></i>
                <span class="setting-text">My Dashboard</span>
              </div>
              <i class="bi bi-chevron-right setting-arrow"></i>
            </a>
            <a href="{% url 'images:list' %}" class="setting-item" style="text-decoration: none; color: inherit;">
              <div class="setting-info">
                <i class="bi bi-collection setting-icon"></i>
                <span class="setting-text">Images</span>
              </div>
              <i class="bi bi-chevron-right setting-arrow"></i>
            </a>
            <a href="{% url 'user_list' %}" class="setting-item" style="text-decoration: none; color: inherit;">
              <div class="setting-info">
                <i class="bi bi-people setting-icon"></i>
                <span class="setting-text">People</span>
              </div>
              <i class="bi bi-chevron-right setting-arrow"></i>
            </a>
            {% else %}
            <div class="setting-item">
              <div class="setting-info">
                <i class="bi bi-lock setting-icon"></i>
                <span class="setting-text">Sign in to access features</span>
              </div>
              <i class="bi bi-chevron-right setting-arrow"></i>
            </div>
            {% endif %}
          </div>
        </div>
        {% endblock %}
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="win11-footer">
    © 2025 Bookmarks. All rights reserved.
  </footer>

<!-- Javascript cookie plugin for CSRF token handling -->
<script src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.5/dist/js.cookie.min.js"></script>
<script>
  // csrf token setup for AJAX requests
  const csrftoken = Cookies.get('csrftoken');

  document.addEventListener('DOMContentLoaded', (event) => {
    // Theme selection functionality (safe even if none exist)
    document.querySelectorAll('.theme-option').forEach(option => {
      option.addEventListener('click', function () {
        document.querySelectorAll('.theme-option').forEach(opt => opt.classList.remove('active'));
        this.classList.add('active');
      });
    });

    // Color mode change (GUARDED: only attach if the dropdown exists)
    const dropdown = document.querySelector('.dropdown-custom');
    if (dropdown) {
      dropdown.addEventListener('change', function (e) {
        const value = e.target.value.toLowerCase();
        if (value === 'dark') {
          document.documentElement.style.setProperty('--win11-bg', '#1e1e1e');
          document.documentElement.style.setProperty('--win11-sidebar', '#252525');
          document.documentElement.style.setProperty('--win11-content', '#2d2d2d');
          document.documentElement.style.setProperty('--win11-text-primary', '#ffffff');
          document.documentElement.style.setProperty('--win11-text-secondary', '#c8c6c4');
          document.documentElement.style.setProperty('--win11-border', '#404040');
        } else {
          document.documentElement.style.setProperty('--win11-bg', '#f3f3f3');
          document.documentElement.style.setProperty('--win11-sidebar', '#ffffff');
          document.documentElement.style.setProperty('--win11-content', '#ffffff');
          document.documentElement.style.setProperty('--win11-text-primary', '#323130');
          document.documentElement.style.setProperty('--win11-text-secondary', '#605e5c');
          document.documentElement.style.setProperty('--win11-border', '#e5e5e5');
        }
      });
    }

    {% block domready %}{% endblock %}
  });
</script>

</body>
</html>